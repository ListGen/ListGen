/* MQ PMA Creator - Util
 * Author: bhuelga
 */

// local data of session
var agentData = {
	'default-mls-area' : 'CARMEL HIGHLANDS',
	'mls-area-names' : ['CARMEL HIGHLANDS', 'PEBBLE BEACH'],
	'mls-areas' : {
		'CARMEL HIGHLANDS' : {
			'edit-sections' : {
				'Attention Grabber' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Front Graph' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Front Bar' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Top Image' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'City Highlights' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Area Highlights' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Call To Action' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Inside Bar' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
				'Listings And Sales' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Complete'
				},
			},
			'homeowners' : [
				{	
					'address-id' : '0000',
					'name' : 'Brandon Huelga',
					'address' : '531 Lasuen Mall',
					'last-sale-price' : 1.8,
					'last-sale-date' : '10/10/2018',
					'selling-agent' : 'Kyle Morrison',
					'blocked' : 'Blocked by Agent',
					'past-client' : true
				},
				{	
					'address-id' : '0001',
					'name' : 'Kyle Morrison',
					'address' : '18B E Carmel Valley Rd',
					'last-sale-price' : 2.2,
					'last-sale-date' : '2/07/2017',
					'selling-agent' : 'Kyle Morrison',
					'blocked' : '',
					'past-client' : true
				},
				{	
					'address-id' : '0002',
					'name' : 'Bill Jones',
					'address' : '1215 Santa Barbara Lane',
					'last-sale-price' : 6.2,
					'last-sale-date' : '5/21/2012',
					'selling-agent' : 'Seamus Riley',
					'blocked' : 'Active Listing',
					'past-client' : false

				},
				{	
					'address-id' : '0003',
					'name' : 'Tom Hanks',
					'address' : '1992 Wilson Place',
					'last-sale-price' : 10.875,
					'last-sale-date' : '6/23/1991',
					'selling-agent' : 'Meryl Streep',
					'blocked' : 'Returned Mail',
					'past-client' : false

				},
				{	
					'address-id' : '0004',
					'name' : 'Mario Luigi',
					'address' : '1984 Rainbow Rd',
					'last-sale-price' : .35,
					'last-sale-date' : '5/21/2013',
					'selling-agent' : 'Seamus Riley',
					'blocked' : '',
					'past-client' : false
				},
				{	
					'address-id' : '0005',
					'name' : 'Ellen Ripley',
					'address' : '7 Nostrodamus',
					'last-sale-price' : 22000,
					'last-sale-date' : '5/25/1979',
					'selling-agent' : 'Ridley Scott',
					'blocked' : 'Blocked by Homeowner',
					'past-client' : false
				}
			],
			'final-preview' : {
				'Attention Grabber' : {
					'time-confirmed' : ''
				},
				'Front Graph' : {
					'time-confirmed' : ''
				},
				'Front Bar' : {
					'time-confirmed' : ''
				},
				'Top Image' : {
					'time-confirmed' : ''
				},
				'City Highlights' : {
					'time-confirmed' : ''
				},
				'Area Highlights' : {
					'time-confirmed' : ''
				},
				'Call To Action' : {
					'time-confirmed' : ''
				},
				'Inside Bar' : {
					'time-confirmed' : ''
				},
				'Listings And Sales' : {
					'time-confirmed' : ''
				}
			},
			'editor-complete' : false,
			'mailing-complete' : false,
			'total-complete' : false,
			'num-mailings' : 2,
			'area-price' : 3.2
		},
		'PEBBLE BEACH' : {
			'edit-sections' : {
				'Attention Grabber' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Front Graph' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Front Bar' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Top Image' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'City Highlights' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Area Highlights' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Call To Action' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Inside Bar' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
				'Listings And Sales' : {
					'selection' : '',
					'confirmed-selection' : '',
					'status' : 'Incomplete'
				},
			},
			'homeowners' : [
				{	
					'address-id' : '0000',
					'name' : 'Steven Wilson',
					'address' : '422 Oxford Way',
					'last-sale-price' : 7.0,
					'last-sale-date' : '12/10/2013',
					'selling-agent' : 'Michael Jones',
					'blocked' : '',
					'past-client' : false
				},
				{	
					'address-id' : '0001',
					'name' : 'Kyle Morrison',
					'address' : '18B E Carmel Valley Rd',
					'last-sale-price' : 2.2,
					'last-sale-date' : '2/07/2017',
					'selling-agent' : 'Kyle Morrison',
					'blocked' : '',
					'past-client' : true
				},
				{	
					'address-id' : '0002',
					'name' : 'Bill Jones',
					'address' : '1215 Santa Barbara Lane',
					'last-sale-price' : 6.2,
					'last-sale-date' : '5/21/2012',
					'selling-agent' : 'Seamus Riley',
					'blocked' : '',
					'past-client' : false

				},
				{	
					'address-id' : '0003',
					'name' : 'Tom Hanks',
					'address' : '1992 Wilson Place',
					'last-sale-price' : 10.875,
					'last-sale-date' : '6/23/1991',
					'selling-agent' : 'Meryl Streep',
					'blocked' : '',
					'past-client' : false

				},
				{	
					'address-id' : '0004',
					'name' : 'Steve Rodgers',
					'address' : '12 Marvel Dr',
					'last-sale-price' : 300,
					'last-sale-date' : '5/28/2015',
					'selling-agent' : 'Tony Stark',
					'blocked' : 'Blocked by Homeowner',
					'past-client' : false
				}
			],
			'final-preview' : {
				'Attention Grabber' : {
					'time-confirmed' : ''
				},
				'Front Graph' : {
					'time-confirmed' : ''
				},
				'Front Bar' : {
					'time-confirmed' : ''
				},
				'Top Image' : {
					'time-confirmed' : ''
				},
				'City Highlights' : {
					'time-confirmed' : ''
				},
				'Area Highlights' : {
					'time-confirmed' : ''
				},
				'Call To Action' : {
					'time-confirmed' : ''
				},
				'Inside Bar' : {
					'time-confirmed' : ''
				},
				'Listings And Sales' : {
					'time-confirmed' : ''
				}
			},
			'editor-complete' : false,
			'mailing-complete' : false,
			'total-complete' : false,
			'num-mailings' : 4,
			'area-price' : 6.4
		}
	},
	'personal-info' : {
		'Agent Logo' : '../../images/templates/logo.PNG',
		'Brokerage Logo' : '../../images/templates/sothebys.png',
		'Return Address 1' : '16B E Carmel Valley Rd',
		'Return Address 2' : 'Carmel Valley, CA 93924',
		'Mailing Address 1' : '',
		'Mailing Address 2' : '',
		'Front Website' : 'kylemorrisonhomes.com',
		'Phone Number' : '831-555-5555',
		'Email Address' : 'kyle@kylemorrison.com',
	},
	'total-addresses' : 8,
	'total-mailings' : 6,
	'total-price' : 9.60
};

// section names to ids
const NAME_TO_ID = {
	'Attention Grabber' : 'attention-grabber',
	'Front Graph' : 'front-graph',
	'Front Bar' : 'front-bar',
	'Top Image' : 'top-image',
	'City Highlights' : 'city-highlights',
	'Area Highlights' : 'area-highlights',
	'Call To Action' : 'call-to-action',
	'Inside Bar' : 'inside-bar',
	'Listings And Sales' : 'listings-and-sales'
}

// section ids to names
const ID_TO_NAME = {
	'attention-grabber' : 'Attention Grabber',
	'front-graph' : 'Front Graph',
	'front-bar' : 'Front Bar',
	'top-image' : 'Top Image',
	'city-highlights' : 'City Highlights',
	'area-highlights' : 'Area Highlights',
	'call-to-action' : 'Call To Action',
	'inside-bar' : 'Inside Bar',
	'listings-and-sales' : 'Listings And Sales'
}

// price per mailing standard PMA
const mailingPrice = 1.6;

// W x H in inches of PMA
const PMA_SIZE = [17, 11];

// Number of sections
const NUM_SECTIONS = 9;

// colors 
const STATUS_COLORS = {
	'Incomplete' : '#FF3A38',
	'Complete' : '#33C451',
};

const WINDOW_HEIGHTS = {
	'Editor' : 'auto',
	'Mailing List' : 1060,
	'Final Preview' : 5000,
	'Incomplete' : 1060
};

const MONTHS = {
	0 : 'Jan',
	1 : 'Feb',
	2 : 'Mar',
	3 : 'Apr',
	4 : 'May',
	5 : 'Jun',
	6 : 'Jul',
	7 : 'Aug',
	8 : 'Sep',
	9 : 'Oct',
	10 : 'Nov',
	11 : 'Dec'
}

// mailing list options
const mailingListOptions = {
	valueNames : ['address-id', 'blocked', 'name', 'address', 'last-sale-price', 'last-sale-date', 'selling-agent'],
	item: `<tr>
			   <td class="address-id-container">
			       <div class="address-id"></div>
			       <strong class="lookup-number"></strong>
			   </td>
			   <td class="blocked-container">
			       <label class="check-container">
			           <input class="block-check" type="checkbox"/>
			           <span class="checkmark"><i class="material-icons">close</i></span>
			           <span class="blocked"></span>
		           </label>
	           </td>
	           <td class="name"></td>
	           <td class="address"></td>
	           <td class="last-sale-price"></td>
	           <td class="last-sale-date"></td>
	           <td class="selling-agent"></td>
           </tr>`
};

/* Draw Image On Canvas
 * ---------------------
 * Draws the source image on the canvas at the specific size and coordinates.
 */
function drawImageOnCanvas(src, canvas, left, top, width, height) {
	let img = new Image();
	let context = canvas.getContext('2d');

	img.onload = () => {
		context.drawImage(img, left, top, width, height);
	};

	img.src = src;
	return img;
}

function getDateAndTime() {
	const date = new Date();
	const day = date.getDate();
	const month = MONTHS[date.getMonth()];
	const year = date.getFullYear();
	const hour = date.getHours();
	const minute = date.getMinutes();
	return month + ' ' + day + ', ' + year + ' at ' + hour + ':' + minute;
}

function addTooltip(container, message) {
	container.addClass('tooltip');
	container.append($('<div class="tooltiptext">' + message + '</div>'));
}

function updateCurrentAreaText() { $('.insert-current-area').html(currentArea); }
function updateCurrentStepText() { $('.insert-current-step').html(currentStep); }